<!DOCTYPE html>
<html lang="es">
<head>
	<title>Mantenedor de Productos</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS: -->

	<!-- Fonts - Font Awesome core CSS -->
	<link href="frontend/resources/libraries/fontawesome-free-5.13.1-web/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="frontend/resources/libraries/fonts/loadfonts.css" rel="stylesheet" type="text/css">

	<!-- Bootstrap 5 core CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<!-- Estilos personalizados para las plantillas -->
	<link href="frontend/resources/libraries/styles/custom-bootstrap.css" rel="stylesheet" type="text/css">
</head>

<body>
	<!-- ENCABEZADO: -->
	<header id="app-header">
		<!-- SPINNER DE CARGA DE PÁGINA. -->
		<div class="bg-spinner" v-if="spinner">
			<div class="spinner-grow text-muted"></div>
			<div class="spinner-grow text-primary"></div>
			<div class="spinner-grow text-success"></div>
			<div class="spinner-grow text-info"></div>
			<div class="spinner-grow text-warning"></div>
			<div class="spinner-grow text-danger"></div>
			<div class="spinner-grow text-secondary"></div>
			<div class="spinner-grow text-dark"></div>
			<div class="spinner-grow text-light"></div>
		</div>

		<div class="container">
			<div class="shadow-lg p-2 bg-body rounded">
				<h1 class="fst-italic text-primary text-center">{{ titulo }}</h1>
			</div>
		</div>
	</header>

	<!-- CUERPO PRINCIPAL: -->
	<main id="app-main">
		<!-- SECCIÓN: RESPUESTA DE SOLICITUDES -->
		<section>
			<div class="bg-response" v-if="respuesta.visible">
				<div class="container">
					<div class="alert alert-success alert-dismissible fade show" role="alert" v-if="respuesta.resultado">
						<h4 class="alert-heading">¡Solicitud exitosa!</h4>
						<p class="mb-0">{{ respuesta.mensaje }}</p>
						<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" v-on:click="respuesta.visible = false"></button>
					</div>
					<div class="alert alert-danger alert-dismissible fade show" role="alert" v-else>
						<h4 class="alert-heading">¡Error!</h4>
						<p class="mb-0">{{ respuesta.mensaje }}</p>
						<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" v-on:click="respuesta.visible = false"></button>
					</div>
				</div>
			</div>
		</section>

		<!-- SECCIÓN: TABLA DE PRODUCTOS -->
		<section>
			<div class="container">
				<div class="d-flex justify-content-end">
					<button class="btn btn-outline-primary" type="button" title="Crear producto" v-on:click="cargarModal1">
						<i class="fas fa-plus-circle fa-lg"></i>
					</button>
				</div>

				<div class="table-responsive">
					<table class="table table-striped table-bordered caption-top">
						<caption>Cantidad de registros: {{ cantidad }}</caption>
						<thead>
							<tr>
								<th class="text-center" v-for="columna in columnas">{{ columna }}</th>
							</tr>
						</thead>
						<tbody>
							<tr v-if="!loading && cantidad > 0" v-for="producto in productos">
								<td class="text-end">{{ producto.codigo }}</td>
								<td class="text-center">{{ producto.nombre }}</td>
								<td class="text-center">{{ producto.categoria }}</td>
								<td class="text-center">{{ producto.fechaCreacion }}</td>
								<td class="text-center">{{ producto.fechaActualizacion }}</td>
								<td class="text-center">
									<div class="btn-group" role="group" aria-label="Herramientas">
										<button class="btn btn-outline-primary" type="button" title="Actualizar producto" v-on:click="cargarModal2(producto.id)">
											<i class="fas fa-edit fa-lg"></i>
										</button>
										<button class="btn btn-outline-primary" type="button" title="Eliminar producto" v-on:click="cargarModal3(producto.id)">
											<i class="fas fa-trash fa-lg"></i>
										</button>
									</div>
								</td>
							</tr>
							<tr v-else-if="!loading && cantidad == 0">
								<td class="text-center" colspan="6">
									No existen productos registrados.
								</td>
							</tr>
							<tr v-else>
								<td class="text-center" colspan="6">
									<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Cargando...
								</td>
							</tr>
						</tbody>
						<tfoot>
							<tr>
								<th class="text-center" v-for="columna in columnas">{{ columna }}</th>
							</tr>
						</tfoot>
					</table>
				</div>
			</div>
		</section>
	</main>

	<!-- PIE DE PÁGINA: -->
	<footer class="bg-primary" id="app-footer">
		<div class="container">
			<span>{{ copyright }}</span>
		</div>

		<!-- BOTÓN FLOTANTE PARA SUBIR AL TOP DE LA PÁGINA: -->
		<a class="scroll-up" title="Volver arriba" v-if="visible" v-on:click="subir">
			<i class="fas fa-arrow-circle-up"></i>
		</a>
	</footer>


	<!-- MODALS: -->

	<!-- MODAL 1: CREACIÓN DE PRODUCTOS -->
	<div class="modal fade" id="modal1">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content" id="app-modal1">
				<form v-on:submit.prevent="guardar">
					<!-- Modal Header -->
					<div class="modal-header">
						<div class="container">
							<h4 class="modal-title text-primary text-center">CREACIÓN DE PRODUCTOS</h4>
						</div>
					</div>

					<!-- Modal body -->
					<div class="modal-body">
					    <div class="container my-4">
							<div class="row g-0">
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">CÓDIGO</span>
								</div>
								<div class="col-lg-9 mb-3">
									<input class="form-control" type="text" v-model="producto.codigo" minlength="3" maxlength="3" placeholder="Ingrese el código del producto" required>
								</div>
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">PRODUCTO</span>
								</div>
								<div class="col-lg-9 mb-3">
									<input class="form-control" type="text" v-model="producto.nombre" maxlength="30" placeholder="Ingrese el nombre del producto" required>
								</div>
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">CATEGORÍA</span>
								</div>
								<div class="col-lg-9">
									<select class="form-select" v-model="producto.idCategoria" required>
										<option value="" selected disabled>Seleccione la categoría del producto</option>
										<option v-for="categoria in categorias" v-bind:value="categoria.id">{{ categoria.descripcion }}</option>
									</select>
								</div>
							</div>
						</div>
					</div>

					<!-- Modal footer -->
					<div class="modal-footer">
						<div class="container">
							<div class="d-grid gap-2 d-md-flex justify-content-md-end">
								<button class="btn btn-outline-primary me-md-2" type="button" v-on:click="cerrar">
									CANCELAR<i class="fas fa-times-circle ms-2"></i>
								</button>
								<button class="btn btn-outline-primary" type="submit">
									<div v-if="loading">
										<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>GUANDANDO...
									</div>
									<div v-else>
										GUARDAR<i class="fas fa-save ms-2"></i>
									</div>
								</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- MODAL 2: ACTUALIZACIÓN DE PRODUCTOS -->
	<div class="modal fade" id="modal2">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content" id="app-modal2">
				<form v-on:submit.prevent="guardar(producto.id)">
					<!-- Modal Header -->
					<div class="modal-header">
						<div class="container">
							<h4 class="modal-title text-primary text-center">ACTUALIZACIÓN DE PRODUCTOS</h4>
						</div>
					</div>

					<!-- Modal body -->
					<div class="modal-body">
					    <div class="container my-4">
							<div class="row g-0">
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">CÓDIGO</span>
								</div>
								<div class="col-lg-9 mb-3">
									<input class="form-control" type="text" v-model="producto.codigo" maxlength="3" placeholder="Ingrese el código del producto" requiredrr>
								</div>
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">PRODUCTO</span>
								</div>
								<div class="col-lg-9 mb-3">
									<input class="form-control" type="text" v-model="producto.nombre" maxlength="30" placeholder="Ingrese el nombre del producto" required>
								</div>
								<div class="col-lg-3">
									<span class="input-group-text bg-primary text-white">CATEGORÍA</span>
								</div>
								<div class="col-lg-9">
									<select class="form-select" v-model="producto.idCategoria" required>
										<option value="" selected disabled>Seleccione la categoría del producto</option>
										<option v-for="categoria in categorias" v-bind:value="categoria.id">{{ categoria.descripcion }}</option>
									</select>
								</div>
							</div>
						</div>
					</div>

					<!-- Modal footer -->
					<div class="modal-footer">
						<div class="container">
							<div class="d-grid gap-2 d-md-flex justify-content-md-end">
								<button class="btn btn-outline-primary me-md-2" type="button" v-on:click="cerrar">
									CANCELAR<i class="fas fa-times-circle ms-2"></i>
								</button>
								<button class="btn btn-outline-primary" type="submit">
									<div v-if="loading">
										<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>GUANDANDO...
									</div>
									<div v-else>
										GUARDAR CAMBIOS<i class="fas fa-save ms-2"></i>
									</div>
								</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- MODAL 3: ELIMINACIÓN DE PRODUCTOS -->
	<div class="modal fade" id="modal3">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content" id="app-modal3">
				
				<!-- Modal Header -->
				<div class="modal-header">
					<div class="container">
						<h4 class="modal-title text-primary text-center">ELIMINACIÓN DE PRODUCTOS</h4>
					</div>
				</div>

				<!-- Modal body -->
				<div class="modal-body">
				    <div class="container my-4">
						<div class="row g-0">
							<div class="col-lg-3">
								<span class="input-group-text bg-primary text-white">CÓDIGO</span>
							</div>
							<div class="col-lg-9 mb-3">
								<p class="input-group-text">{{ producto.codigo }}</p>
							</div>
							<div class="col-lg-3">
								<span class="input-group-text bg-primary text-white">PRODUCTO</span>
							</div>
							<div class="col-lg-9 mb-3">
								<p class="input-group-text">{{ producto.nombre }}</p>
							</div>
							<div class="col-lg-3">
								<span class="input-group-text bg-primary text-white">CATEGORÍA</span>
							</div>
							<div class="col-lg-9 mb-5">
								<p class="input-group-text">{{ producto.categoria }}</p>
							</div>
							<div class="col-lg-9 mx-auto">
								<h6 class="text-primary text-center">¿ESTÁS SEGURO DE ELIMINAR EL PRODUCTO?</h6>
							</div>
						</div>
					</div>
				</div>

				<!-- Modal footer -->
				<div class="modal-footer">
					<div class="container">
						<div class="d-grid gap-2 d-md-flex justify-content-md-end">
							<button class="btn btn-outline-primary me-md-2" type="button" v-on:click="cerrar">
								CANCELAR<i class="fas fa-times-circle ms-2"></i>
							</button>
							<button class="btn btn-outline-primary" type="button" v-on:click="confirmar(producto.id)">
								<div v-if="loading">
									<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>ELIMINANDO...
								</div>
								<div v-else>
									CONFIRMAR<i class="fas fa-check-circle ms-2"></i>
								</div>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- SCRIPTS: -->

	<!-- Vue-JS versión de desarrollo. (Incluye advertencias de ayuda en la consola). -->
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

	<!-- Vue-JS versión de producción. (Optimizada para tamaño y velocidad). -->
	<!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->

	<!-- Bootstrap 5 core JavaScript -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

	<!-- Scripts con la lógica de la vista -->
	<script src="frontend/views/js/index.js" type="text/javascript"></script>
	<script src="frontend/views/js/services.js" type="text/javascript"></script>
	<script src="frontend/views/js/instances.js" type="text/javascript"></script>
</body>
</html>
